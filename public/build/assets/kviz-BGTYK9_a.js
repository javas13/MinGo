$(document).ready(function(){function l(t){t.closest(".question").querySelectorAll(".kviz-answer-btn-js").forEach(e=>{e.classList.remove("selected"),e.dataset.selected="false"}),t.classList.add("selected"),t.dataset.selected="true"}$(".kviz-answer-btn-js").click(function(t){l(this)}),$("#quizForm").submit(function(t){t.preventDefault();const s=document.getElementById("loadingOverlay");s.style.display="flex";const e=this.querySelector('button[type="submit"]');e.disabled=!0,e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Обработка...';const r=new FormData,i=document.querySelectorAll(".question");let o="";i.forEach((n,d)=>{const a=n.querySelector('.kviz-answer-btn-js[data-selected="true"]');if(!a){s.style.display="none",e.disabled=!1,e.textContent="Найти места",Swal.fire("Ошибка!","Пожалуйста ответьте на все вопросы","error"),o="error";return}r.append(a.dataset.question,a.dataset.value)}),o==""&&$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:"/kviz-search",data:r,processData:!1,contentType:!1}).done(function(n){setTimeout(function(){s.style.display="none",e.disabled=!1,e.textContent="Найти места",window.location.href=n.data},1e3)}).fail(function(){setTimeout(function(){s.style.display="none",e.disabled=!1,e.textContent="Найти места",Swal.fire("Ошибка!","Неизвестная ошибка","error")},1e3)})})});
